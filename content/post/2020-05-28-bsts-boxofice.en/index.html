---
title: 'Bayesian Time Series Intro: Weekly Box Office'
author: Dylan O'Connell
date: '2020-05-28'
slug: bsts-boxofice
categories: []
tags:
  - bayesian
  - R
subtitle: ''
summary: ''
authors: []
lastmod: '2020-05-28T13:54:36-04:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
---



<p>abc</p>
<pre><code>## Registered S3 method overwritten by &#39;rvest&#39;:
##   method            from
##   read_xml.response xml2</code></pre>
<pre><code>## ── Attaching packages ────────────────────────────────── tidyverse 1.2.1 ──</code></pre>
<pre><code>## ✓ ggplot2 3.2.1     ✓ purrr   0.3.4
## ✓ tibble  2.1.1     ✓ dplyr   0.8.3
## ✓ tidyr   0.8.3     ✓ stringr 1.4.0
## ✓ readr   1.3.1     ✓ forcats 0.4.0</code></pre>
<pre><code>## Warning: package &#39;purrr&#39; was built under R version 3.6.2</code></pre>
<pre><code>## ── Conflicts ───────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre><code>## Warning: package &#39;bsts&#39; was built under R version 3.6.2</code></pre>
<pre><code>## Loading required package: BoomSpikeSlab</code></pre>
<pre><code>## Warning: package &#39;BoomSpikeSlab&#39; was built under R version 3.6.2</code></pre>
<pre><code>## Loading required package: Boom</code></pre>
<pre><code>## Warning: package &#39;Boom&#39; was built under R version 3.6.2</code></pre>
<pre><code>## Loading required package: MASS</code></pre>
<pre><code>## 
## Attaching package: &#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     select</code></pre>
<pre><code>## 
## Attaching package: &#39;Boom&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     rWishart</code></pre>
<pre><code>## 
## Attaching package: &#39;BoomSpikeSlab&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     knots</code></pre>
<pre><code>## Loading required package: zoo</code></pre>
<pre><code>## Warning: package &#39;zoo&#39; was built under R version 3.6.2</code></pre>
<pre><code>## 
## Attaching package: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<pre><code>## Loading required package: xts</code></pre>
<pre><code>## 
## Attaching package: &#39;xts&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     first, last</code></pre>
<pre><code>## 
## Attaching package: &#39;bsts&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:BoomSpikeSlab&#39;:
## 
##     SuggestBurn</code></pre>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     date</code></pre>
<div id="setup" class="section level1">
<h1>Setup</h1>
<p>We have a .csv file containing the weekly</p>
<pre class="r"><code>weekly.tb &lt;- read_csv(&quot;weekly_gross.csv&quot;)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   year = col_double(),
##   week = col_double(),
##   gross = col_double(),
##   top_release = col_character(),
##   releases = col_double(),
##   long_weekend = col_logical()
## )</code></pre>
<pre class="r"><code>select &lt;- dplyr::select
weekly.tb</code></pre>
<pre><code>## # A tibble: 2,067 x 6
##     year  week    gross top_release                        releases long_weekend
##    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;                                 &lt;dbl&gt; &lt;lgl&gt;       
##  1  1980     1  7614000 Kramer vs. Kramer                         1 FALSE       
##  2  1980     3  9970342 Kramer vs. Kramer                         3 FALSE       
##  3  1980     4  8295181 Kramer vs. Kramer                         2 FALSE       
##  4  1980     5 26605665 American Gigolo                           3 FALSE       
##  5  1980     6 24424638 Hero at Large                             4 FALSE       
##  6  1980     7 12312572 The Last Married Couple in America        2 FALSE       
##  7  1980     9 19702207 Kramer vs. Kramer                         2 FALSE       
##  8  1980    10  8879852 Coal Miner&#39;s Daughter                     2 FALSE       
##  9  1980    11  4276651 Kramer vs. Kramer                         2 FALSE       
## 10  1980    12  7686531 Hide in Plain Sight                       3 FALSE       
## # … with 2,057 more rows</code></pre>
<pre class="r"><code>weekly.tb &lt;- weekly.tb %&gt;%
  as_tibble() %&gt;%
  filter(year &gt;= 1993) %&gt;%
  mutate(time = year + (week-1)/52,
         log_gross = log10(gross),
         date = date_decimal(time)) %&gt;%
  dplyr::select(date, time, gross, log_gross, releases, everything())</code></pre>
</div>
